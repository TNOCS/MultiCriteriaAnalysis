<div data-ng-controller="CriteriasCtrl as d" style="overflow-y: auto; overflow-x: hidden" resize resize-y="100">
    <h1>Criterias</h1>

    <div ng-show="!reorder" ng-click="reorder = !reorder" class="lock"><i class="fa fa-lock"></i><a style="margin-left: 5px">enable reorder</a></div>
    <div ng-show="reorder" ng-click="reorder = !reorder" class="lock"><i class="fa fa-unlock"></i><a style="margin-left: 5px">disable reorder</a></div>

    <script type="text/ng-template" id="options_renderer.html">
        <div ui-tree-handle data-nodrag style="cursor:auto">
            <span class="glyphicon glyphicon-list" style="margin-right:4px; opacity:0.25; color:grey" />
            <span contenteditable ng-model="item.title" style="font-size:20px;cursor:text" data-nodrag></span>            
            <input type="number" ng-model="item.value" min="0" max="1" step="0.1" class="criteriaOptionValue" placeholder="value">

            <span class="label" ng-class="{'label-warning': percent<30, 'label-info': percent>=30 && percent<70, 'label-success': percent>=70}" ng-show="overStar && !isReadonly">{{percent}}%</span>
            <a class="pull-right btn btn-danger btn-xs" data-nodrag ng-click="remove(this)"><span class="glyphicon glyphicon-remove"></span></a>

        </div>
    </script>


    <script type="text/ng-template" id="items_renderer.html">
        <div ui-tree-handle>
            <a class="btn btn-success btn-xs" data-nodrag ng-click="toggle(this)"><span class="glyphicon" ng-class="{'glyphicon-chevron-right': collapsed, 'glyphicon-chevron-down': !collapsed}"></span></a>
            <span contenteditable ng-model="item.title" style="font-size:20px;cursor:text" data-nodrag></span>
            <select class="criteriaDataSourceSelect" data-ng-options="ds.id as ds.title for ds in vm.projectService.project.dataSources" data-ng-model="item.dataSourceId"></select>
            <rating class="criteriaRating" ng-model="item.userWeight" max="5" readonly="isReadonly" on-hover="hoveringOver(value)" on-leave="overStar = null"></rating>
            <span class="label" ng-class="{'label-warning': percent<30, 'label-info': percent>=30 && percent<70, 'label-success': percent>=70}" ng-show="overStar && !isReadonly">{{percent}}%</span>
            <a class="pull-right btn btn-danger btn-xs" data-nodrag ng-click="remove(this)"><span class="glyphicon glyphicon-remove"></span></a>
            <a class="pull-right btn btn-primary btn-xs" data-nodrag ng-if="item.canHaveOptions()" ng-click="newOption(this)" style="margin-right: 8px;"><span class="glyphicon glyphicon-list"></span></a>

            <a class="pull-right btn btn-primary btn-xs" data-nodrag ng-if="item.canHaveSubs()" ng-click="newSubCriteria(this)" style="margin-right: 8px;"><span class="glyphicon glyphicon-plus"></span></a>
        </div>
        <ol ui-tree-nodes="options" ng-model="item.subCriterias" ng-class="{hidden: collapsed}">
            <li ng-repeat="item in item.subCriterias" ui-tree-node ng-include="'items_renderer.html'">
            </li>
        </ol>
        <ol ui-tree-nodes="options" ng-model="item.options" ng-class="{hidden: collapsed}">
            <li ng-repeat="item in item.options" ui-tree-node ng-include="'options_renderer.html'">
            </li>
        </ol>
    </script>
    <div ui-tree="options" data-drag-enabled="reorder" data-drag-delay="500" style="margin-top:40px">
        <ol ui-tree-nodes ng-model="d.projectService.project.criterias">
            <li ng-repeat="item in d.projectService.project.criterias" ui-tree-node ng-include="'items_renderer.html'"></li>
        </ol>
    </div>
    <a class="pull-right btn btn-primary btn-xs" ng-click="newCriteria()" style="margin-right: 18px;margin-top:10px"><span class="glyphicon glyphicon-plus"></span></a>



</div>